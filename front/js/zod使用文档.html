<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>zodä½¿ç”¨æ–‡æ¡£æ€»ç»“æ±‡æ€» | å¤§å‰ç«¯</title>
    <meta name="description" content="å‰ç«¯çŸ¥è¯†ä½“ç³»å»ºè®¾">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/assets/css/0.styles.bcf422a7.css" as="style"><link rel="preload" href="/assets/js/app.cb69e367.js" as="script"><link rel="preload" href="/assets/js/2.97e62447.js" as="script"><link rel="preload" href="/assets/js/19.e931611d.js" as="script"><link rel="prefetch" href="/assets/js/10.4feea8e6.js"><link rel="prefetch" href="/assets/js/11.d0f55222.js"><link rel="prefetch" href="/assets/js/12.78e61d7e.js"><link rel="prefetch" href="/assets/js/13.fc23d13b.js"><link rel="prefetch" href="/assets/js/14.1821acb8.js"><link rel="prefetch" href="/assets/js/15.aed09044.js"><link rel="prefetch" href="/assets/js/16.4595878b.js"><link rel="prefetch" href="/assets/js/17.2c66c4cb.js"><link rel="prefetch" href="/assets/js/18.d0927fc3.js"><link rel="prefetch" href="/assets/js/20.835e596e.js"><link rel="prefetch" href="/assets/js/21.e85ab81d.js"><link rel="prefetch" href="/assets/js/22.ffb1218f.js"><link rel="prefetch" href="/assets/js/23.25dc22c5.js"><link rel="prefetch" href="/assets/js/24.1b69242f.js"><link rel="prefetch" href="/assets/js/25.b8458ebd.js"><link rel="prefetch" href="/assets/js/26.5e4d1ef0.js"><link rel="prefetch" href="/assets/js/27.35707f38.js"><link rel="prefetch" href="/assets/js/28.454f3ece.js"><link rel="prefetch" href="/assets/js/29.9f919dde.js"><link rel="prefetch" href="/assets/js/3.ddeae314.js"><link rel="prefetch" href="/assets/js/30.06fb66c7.js"><link rel="prefetch" href="/assets/js/31.67eae056.js"><link rel="prefetch" href="/assets/js/32.6e083401.js"><link rel="prefetch" href="/assets/js/33.e4e4068c.js"><link rel="prefetch" href="/assets/js/34.14bb4422.js"><link rel="prefetch" href="/assets/js/35.52347c0c.js"><link rel="prefetch" href="/assets/js/36.b746d2f6.js"><link rel="prefetch" href="/assets/js/37.cadf6b91.js"><link rel="prefetch" href="/assets/js/38.d4685da1.js"><link rel="prefetch" href="/assets/js/39.c574b892.js"><link rel="prefetch" href="/assets/js/4.db7235d4.js"><link rel="prefetch" href="/assets/js/40.1fac81c8.js"><link rel="prefetch" href="/assets/js/41.ea31e6dd.js"><link rel="prefetch" href="/assets/js/42.4ad1d79f.js"><link rel="prefetch" href="/assets/js/43.143c80d2.js"><link rel="prefetch" href="/assets/js/44.eda7091f.js"><link rel="prefetch" href="/assets/js/45.513a1c1d.js"><link rel="prefetch" href="/assets/js/46.a03ae126.js"><link rel="prefetch" href="/assets/js/47.5d8a3c88.js"><link rel="prefetch" href="/assets/js/48.bc6fa5e4.js"><link rel="prefetch" href="/assets/js/49.14dc2ecc.js"><link rel="prefetch" href="/assets/js/5.50f8abaf.js"><link rel="prefetch" href="/assets/js/50.e2a14907.js"><link rel="prefetch" href="/assets/js/51.91d9ca44.js"><link rel="prefetch" href="/assets/js/52.de014759.js"><link rel="prefetch" href="/assets/js/53.b0cf3bbb.js"><link rel="prefetch" href="/assets/js/54.c3d0e3db.js"><link rel="prefetch" href="/assets/js/55.40caf057.js"><link rel="prefetch" href="/assets/js/56.e6016740.js"><link rel="prefetch" href="/assets/js/57.5c3e9644.js"><link rel="prefetch" href="/assets/js/58.0832ed49.js"><link rel="prefetch" href="/assets/js/59.326d0ed1.js"><link rel="prefetch" href="/assets/js/6.5931ecd3.js"><link rel="prefetch" href="/assets/js/60.e91910fb.js"><link rel="prefetch" href="/assets/js/61.93fcb862.js"><link rel="prefetch" href="/assets/js/62.8af0d998.js"><link rel="prefetch" href="/assets/js/63.535dc2ab.js"><link rel="prefetch" href="/assets/js/7.1fdc2758.js"><link rel="prefetch" href="/assets/js/8.d75c6c5f.js"><link rel="prefetch" href="/assets/js/9.a2e23ed2.js">
    <link rel="stylesheet" href="/assets/css/0.styles.bcf422a7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo.svg" alt="å¤§å‰ç«¯" class="logo"> <span class="site-name can-hide">å¤§å‰ç«¯</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å‰ç«¯" class="dropdown-title"><span class="title">å‰ç«¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/front/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/front/js/" class="nav-link router-link-active">
  javaScript
</a></li><li class="dropdown-item"><!----> <a href="/front/browser/" class="nav-link">
  browser
</a></li><li class="dropdown-item"><!----> <a href="/front/react/" class="nav-link">
  react
</a></li><li class="dropdown-item"><!----> <a href="/front/other/" class="nav-link">
  æ—¥å¸¸è®°å½•
</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">
  å…³äºæˆ‘
</a></div> <a href="https://github.com/qsg1215/myitsky" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å‰ç«¯" class="dropdown-title"><span class="title">å‰ç«¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front/html/" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/front/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/front/js/" class="nav-link router-link-active">
  javaScript
</a></li><li class="dropdown-item"><!----> <a href="/front/browser/" class="nav-link">
  browser
</a></li><li class="dropdown-item"><!----> <a href="/front/react/" class="nav-link">
  react
</a></li><li class="dropdown-item"><!----> <a href="/front/other/" class="nav-link">
  æ—¥å¸¸è®°å½•
</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">
  å…³äºæˆ‘
</a></div> <a href="https://github.com/qsg1215/myitsky" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>javaScript</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front/js/" class="sidebar-link">typeScript</a></li><li><a href="/front/js/ts.html" class="sidebar-link">typeScript å®è·µ</a></li><li><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html" class="active sidebar-link">zodä½¿ç”¨æ–‡æ¡£æ€»ç»“æ±‡æ€»</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#åŸå§‹å€¼ç±»å‹ï¼ˆprimitiveï¼‰" class="sidebar-link">åŸå§‹å€¼ç±»å‹ï¼ˆprimitiveï¼‰</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#å­—é¢é‡ï¼ˆliteralï¼‰" class="sidebar-link">å­—é¢é‡ï¼ˆliteralï¼‰</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#å­—ç¬¦ä¸²" class="sidebar-link">å­—ç¬¦ä¸²</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#numbers" class="sidebar-link">Numbers</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#dates" class="sidebar-link">Dates</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#objects" class="sidebar-link">Objects</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#shape" class="sidebar-link">.shape</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#extend" class="sidebar-link">.extend</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#merge" class="sidebar-link">.merge</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#pick-omit" class="sidebar-link">.pick/.omit</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#partial" class="sidebar-link">.partial</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#deeppartial" class="sidebar-link">.deepPartial</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#passthrough" class="sidebar-link">.passthrough</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#strict" class="sidebar-link">.strict</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#strip" class="sidebar-link">.strip</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#catchall" class="sidebar-link">.catchall</a></li></ul></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#arrays" class="sidebar-link">Arrays</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#nonempty" class="sidebar-link">.nonempty</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#min-max-length" class="sidebar-link">.min/.max/.length</a></li></ul></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#unions" class="sidebar-link">Unions</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#optionals" class="sidebar-link">Optionals</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#nullables" class="sidebar-link">Nullables</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#records" class="sidebar-link">Records</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#maps" class="sidebar-link">Maps</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#sets" class="sidebar-link">Sets</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#enums" class="sidebar-link">Enums</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#zod-enums" class="sidebar-link">Zod enums</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#native-enums" class="sidebar-link">Native enums</a></li></ul></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#intersections" class="sidebar-link">Intersections</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#tuples" class="sidebar-link">Tuples</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#recursive-types" class="sidebar-link">Recursive types</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#promises" class="sidebar-link">Promises</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#instanceof" class="sidebar-link">Instanceof</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#function-schemas" class="sidebar-link">Function schemas</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#parse" class="sidebar-link">.parse</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#parseasync" class="sidebar-link">.parseAsync</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#safeparse" class="sidebar-link">.safeParse</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#safeparseasync" class="sidebar-link">.safeParseAsync</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#refine" class="sidebar-link">.refine</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#superrefine" class="sidebar-link">.superRefine</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#transform" class="sidebar-link">.transform</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#default" class="sidebar-link">.default</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#optional" class="sidebar-link">.optional</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#nullable" class="sidebar-link">.nullable</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#nullish" class="sidebar-link">.nullish</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#array" class="sidebar-link">.array</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#or" class="sidebar-link">.or</a></li><li class="sidebar-sub-header"><a href="/front/js/zodä½¿ç”¨æ–‡æ¡£.html#and" class="sidebar-link">.and</a></li></ul></li></ul></li><li><a href="/front/js/åŸºç¡€å·¥å…·æ–¹æ³•.html" class="sidebar-link">åŸºç¡€å·¥å…·æ–¹æ³•</a></li><li><a href="/front/js/æ•°æ®ç»“æ„å’Œç®—æ³•.html" class="sidebar-link">æ•°æ®ç»“æ„å’Œç®—æ³•</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="zodä½¿ç”¨æ–‡æ¡£æ€»ç»“æ±‡æ€»"><a href="#zodä½¿ç”¨æ–‡æ¡£æ€»ç»“æ±‡æ€»" class="header-anchor">#</a> zodä½¿ç”¨æ–‡æ¡£æ€»ç»“æ±‡æ€»</h1> <h1 id="apiæ¦‚è§ˆ"><a href="#apiæ¦‚è§ˆ" class="header-anchor">#</a> APIæ¦‚è§ˆ</h1> <ul><li><a href="#%E5%AE%89%E8%A3%85">å®‰è£…</a></li> <li><a href="#%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95">åŸºæœ¬ç”¨æ³•</a></li> <li><a href="#%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%BC%8F">å®šä¹‰æ¨¡å¼</a> <ul><li><a href="#%E5%8E%9F%E5%A7%8B%E5%80%BC%E7%B1%BB%E5%9E%8B%EF%BC%88primitive%EF%BC%89">åŸå§‹å€¼ç±»å‹ï¼ˆprimitiveï¼‰</a></li> <li><a href="#%E5%AD%97%E9%9D%A2%E9%87%8F%EF%BC%88literal%EF%BC%89">å­—é¢é‡ï¼ˆliteralï¼‰</a></li> <li><a href="#%E5%AD%97%E7%AC%A6%E4%B8%B2">å­—ç¬¦ä¸²</a></li> <li><a href="#numbers">Numbers</a></li> <li><a href="#objects">Objects</a> <ul><li><a href="#shape">.shape</a></li> <li><a href="#extend">.extend</a></li> <li><a href="#merge">.merge</a></li> <li><a href="#pickomit">.pick/.omit</a></li> <li><a href="#partial">.partial</a></li> <li><a href="#deepPartial">.deepPartial</a></li> <li><a href="#passthrough">.passthrough</a></li> <li><a href="#strict">.strict</a></li> <li><a href="#strip">.strip</a></li> <li><a href="#catchall">.catchall</a></li></ul></li> <li><a href="#records">Records</a></li> <li><a href="#maps">Maps</a></li> <li><a href="#sets">Sets</a></li> <li><a href="#arrays">Arrays</a> <ul><li><a href="#nonempty">.nonempty</a></li> <li><a href="#minmaxlength">.min/.max/.length</a></li></ul></li> <li><a href="#unions">Unions</a></li> <li><a href="#optionals">Optionals</a></li> <li><a href="#nullables">Nullables</a></li> <li><a href="#enums">Enums</a> <ul><li><a href="#zod-enums">Zod enums</a></li> <li><a href="#native-enums">Native enums</a></li></ul></li> <li><a href="#tuples">Tuples</a></li> <li><a href="#recursive-types">Recursive types</a> <ul><li><a href="#json-type">JSON type</a></li> <li><a href="#cyclical-objects">Cyclical data</a></li></ul></li> <li><a href="#promises">Promises</a></li> <li><a href="#instanceof">Instanceof</a></li> <li><a href="#function-schemas">Function schemas</a></li></ul></li> <li><a href="#zodtype-methods-and-properties">åŸºç¡€ç±»æ–¹æ³• (ZodType)</a> <ul><li><a href="#parse">.parse</a></li> <li><a href="#parseasync">.parseAsync</a></li> <li><a href="#safeparse">.safeParse</a></li> <li><a href="#safeparseasync">.safeParseAsync</a></li> <li><a href="#refine">.refine</a></li> <li><a href="#superRefine">.superRefine</a></li> <li><a href="#transform">.transform</a></li> <li><a href="#default">.default</a></li> <li><a href="#optional">.optional</a></li> <li><a href="#nullable">.nullable</a></li> <li><a href="#nullish">.nullish</a></li> <li><a href="#array">.array</a></li> <li><a href="#or">.or</a></li> <li><a href="#and">.and</a></li></ul></li> <li><a href="#type-inference">ç±»å‹æ¨æ–­</a></li> <li><a href="#errors">Errors</a></li></ul> <h1 id="å®‰è£…"><a href="#å®‰è£…" class="header-anchor">#</a> å®‰è£…</h1> <h3 id="å¿…è¦æ¡ä»¶"><a href="#å¿…è¦æ¡ä»¶" class="header-anchor">#</a> å¿…è¦æ¡ä»¶</h3> <ul><li>TypeScript 4.5+!</li> <li>ä½ å¿…é¡»åœ¨ä½ çš„<code>tsconfig.json</code>ä¸­å¯ç”¨<code>strict</code>æ¨¡å¼ã€‚è¿™æ˜¯æ‰€æœ‰ TypeScript é¡¹ç›®çš„æœ€ä½³å®è·µã€‚</li></ul> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// tsconfig.json</span>
<span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token string">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    <span class="token string">&quot;strict&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="ä»npmå®‰è£…"><a href="#ä»npmå®‰è£…" class="header-anchor">#</a> ä»<code>npm</code>å®‰è£…</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">npm</span> <span class="token function">install</span> zod
<span class="token function">yarn</span> <span class="token function">add</span> zod          <span class="token comment"># yarn</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>README çš„å‰©ä½™éƒ¨åˆ†å‡å®šä½ æ˜¯ç›´æ¥é€šè¿‡ npm å®‰è£…çš„<code>zod</code>åŒ…ã€‚</p></blockquote> <h1 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="header-anchor">#</a> åŸºæœ¬ç”¨æ³•</h1> <p>åˆ›å»ºä¸€ä¸ªç®€å•çš„å­—ç¬¦ä¸²æ¨¡å¼</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> z <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;zod&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²çš„æ¨¡å¼</span>
<span class="token keyword">const</span> mySchema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// è§£æ</span>
mySchema<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;tuna&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; &quot;tuna&quot;</span>
mySchema<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; throws ZodError</span>

<span class="token comment">// &quot;å®‰å…¨&quot;è§£æ(å¦‚æœéªŒè¯å¤±è´¥ä¸æŠ›å‡ºé”™è¯¯)</span>
mySchema<span class="token punctuation">.</span><span class="token function">safeParse</span><span class="token punctuation">(</span><span class="token string">&quot;tuna&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; { success: true; data: &quot;tuna&quot; }</span>
mySchema<span class="token punctuation">.</span><span class="token function">safeParse</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; { success: false; error: ZodError }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>åˆ›å»ºä¸€ä¸ª Object æ¨¡å¼</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> z <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;zod&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> User <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  username<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

User<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">{</span> username<span class="token operator">:</span> <span class="token string">&quot;Ludwig&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æå–å‡ºæ¨æ–­çš„ç±»å‹</span>
<span class="token keyword">type</span> User <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> User<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token comment">// { username: string }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h1 id="å®šä¹‰æ¨¡å¼"><a href="#å®šä¹‰æ¨¡å¼" class="header-anchor">#</a> å®šä¹‰æ¨¡å¼</h1> <h2 id="åŸå§‹å€¼ç±»å‹ï¼ˆprimitiveï¼‰"><a href="#åŸå§‹å€¼ç±»å‹ï¼ˆprimitiveï¼‰" class="header-anchor">#</a> åŸå§‹å€¼ç±»å‹ï¼ˆprimitiveï¼‰</h2> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> z <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;zod&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// åŸå§‹å€¼ç±»å‹</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">bigint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">boolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ç©ºç±»å‹</span>
z<span class="token punctuation">.</span><span class="token keyword">undefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token keyword">null</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token keyword">void</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ¥å— undefined</span>

<span class="token comment">// ä»»æ„ç±»å‹</span>
<span class="token comment">// å…è®¸ä»»æ„ç±»å‹çš„å€¼</span>
z<span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">unknown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// never ç±»å‹</span>
<span class="token comment">// ä¸å…è®¸å€¼ç±»å‹å­˜åœ¨</span>
z<span class="token punctuation">.</span><span class="token function">never</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="å­—é¢é‡ï¼ˆliteralï¼‰"><a href="#å­—é¢é‡ï¼ˆliteralï¼‰" class="header-anchor">#</a> å­—é¢é‡ï¼ˆliteralï¼‰</h2> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> tuna <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">literal</span><span class="token punctuation">(</span><span class="token string">&quot;tuna&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> twelve <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">literal</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> tru <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">literal</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// æ£€ç´¢å­—é¢é‡çš„å€¼</span>
tuna<span class="token punctuation">.</span>value<span class="token punctuation">;</span> <span class="token comment">// &quot;tuna&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>ç›®å‰åœ¨ Zod ä¸­ä¸æ”¯æŒ Date æˆ– bigint å­—é¢ã€‚å¦‚æœä½ æœ‰è¿™ä¸ªåŠŸèƒ½çš„ç”¨ä¾‹ï¼Œè¯·æäº¤ä¸€ä¸ª Issueã€‚</p></blockquote> <h2 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="header-anchor">#</a> å­—ç¬¦ä¸²</h2> <p>Zod åŒ…æ‹¬ä¸€äº›é’ˆå¯¹å­—ç¬¦ä¸²çš„éªŒè¯ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">email</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">regex</span><span class="token punctuation">(</span>regex<span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å·²åºŸå¼ƒï¼Œç­‰åŒäº .min(1)</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nonempty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p>æŸ¥çœ‹ <a href="https://github.com/validatorjs/validator.js" target="_blank" rel="noopener noreferrer">validator.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ï¼Œäº†è§£å…¶ä»–ä¸€äº›æœ‰ç”¨çš„å­—ç¬¦ä¸²éªŒè¯å‡½æ•°</p></blockquote> <h4 id="è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯"><a href="#è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯" class="header-anchor">#</a> è‡ªå®šä¹‰é”™è¯¯ä¿¡æ¯</h4> <p>ä½ å¯ä»¥é€‰æ‹©ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°æ¥æä¾›ä¸€ä¸ªè‡ªå®šä¹‰çš„é”™è¯¯ä¿¡æ¯ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">&quot;Must be 5 or more characters long&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">&quot;Must be 5 or fewer characters long&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">&quot;Must be exactly 5 characters long&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">email</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">&quot;Invalid email address.&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">&quot;Invalid url&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">&quot;Invalid UUID&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;https://&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">&quot;Must provide secure URL&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&quot;.com&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">&quot;Only .com domains allowed&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="numbers"><a href="#numbers" class="header-anchor">#</a> Numbers</h2> <p>Zod åŒ…æ‹¬ä¸€äº›ç‰¹å®šçš„æ•°å­—éªŒè¯ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">gt</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">gte</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// alias .min(5)</span>
z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lt</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lte</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// alias .max(5)</span>

z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å€¼å¿…é¡»æ˜¯ä¸€ä¸ªæ•´æ•°</span>

z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">positive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//     &gt; 0</span>
z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nonnegative</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  &gt;= 0</span>
z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">negative</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//     &lt; 0</span>
z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nonpositive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//  &lt;= 0</span>

z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">multipleOf</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// x % 5 === 0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>ä½ å¯ä»¥é€‰æ‹©ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°æ¥æä¾›ä¸€ä¸ªè‡ªå®šä¹‰çš„é”™è¯¯ä¿¡æ¯ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">&quot;thisğŸ‘isğŸ‘tooğŸ‘big&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="dates"><a href="#dates" class="header-anchor">#</a> Dates</h2> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>z<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">safeParse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// success: true</span>

z<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  required_error<span class="token operator">:</span> <span class="token string">&quot;Please select a date and time&quot;</span><span class="token punctuation">,</span>
  invalid_type_error<span class="token operator">:</span> <span class="token string">&quot;That's not a date!&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

z<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">&quot;1900-01-01&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">&quot;Too old&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token punctuation">.</span><span class="token function">date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">&quot;Too young!&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="objects"><a href="#objects" class="header-anchor">#</a> Objects</h2> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token comment">// æ‰€æœ‰å±æ€§éƒ½æ˜¯é»˜è®¤éœ€è¦çš„</span>
<span class="token keyword">const</span> Dog <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// åƒè¿™æ ·æå–æ¨æ–­å‡ºçš„ç±»å‹</span>
<span class="token keyword">type</span> Dog <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> Dog<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token comment">// ç›¸å½“äº:</span>
<span class="token keyword">type</span> Dog <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="shape"><a href="#shape" class="header-anchor">#</a> <code>.shape</code></h3> <p>ä½¿ç”¨<code>.shape</code>æ¥è®¿é—®ç‰¹å®šé”®çš„æ¨¡å¼ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>Dog<span class="token punctuation">.</span>shape<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">// =&gt; string schema</span>
Dog<span class="token punctuation">.</span>shape<span class="token punctuation">.</span>age<span class="token punctuation">;</span> <span class="token comment">// =&gt; number schema</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="extend"><a href="#extend" class="header-anchor">#</a> <code>.extend</code></h3> <p>ä½ å¯ä»¥ç”¨<code>.extend</code>æ–¹æ³•åœ¨å¯¹è±¡æ¨¡å¼ä¸­æ·»åŠ é¢å¤–çš„å­—æ®µã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> DogWithBreed <span class="token operator">=</span> Dog<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  breed<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ä½ å¯ä»¥ä½¿ç”¨<code>.extend</code>æ¥è¦†ç›–å­—æ®µ! è¦å°å¿ƒä½¿ç”¨è¿™ç§æ–¹å¼!</p> <h3 id="merge"><a href="#merge" class="header-anchor">#</a> <code>.merge</code></h3> <p>ç›¸å½“äº <code>A.extend(B.shape)</code>.</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> BaseTeacher <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span> students<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> HasID <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Teacher <span class="token operator">=</span> BaseTeacher<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>HasID<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> Teacher <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> Teacher<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; { students: string[], id: string }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>å¦‚æœä¸¤ä¸ªæ¨¡å¼å…±äº« keysï¼Œé‚£ä¹ˆ B çš„å±æ€§å°†è¦†ç›– A çš„å±æ€§ã€‚è¿”å›çš„æ¨¡å¼ä¹Ÿç»§æ‰¿äº† &quot;unknownKeys å¯†é’¥ &quot;ç­–ç•¥(strip/strict/passthrough+)å’Œ B çš„å…¨é¢æ¨¡å¼ã€‚</p></blockquote> <h3 id="pick-omit"><a href="#pick-omit" class="header-anchor">#</a> <code>.pick/.omit</code></h3> <p>å— TypeScript å†…ç½®çš„<code>Pick</code>å’Œ<code>Omit</code>å·¥å…·ç±»å‹çš„å¯å‘ï¼Œæ‰€æœ‰ Zod å¯¹è±¡æ¨¡å¼éƒ½æœ‰<code>.pick</code>å’Œ <code>.omit</code>æ–¹æ³•ï¼Œå¯ä»¥è¿”å›ä¸€ä¸ªä¿®æ”¹åçš„ç‰ˆæœ¬ã€‚è€ƒè™‘ä¸€ä¸‹è¿™ä¸ª Recipe æ¨¡å¼ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> Recipe <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  ingredients<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>è¦æƒ³åªä¿ç•™æŸäº› Keyï¼Œä½¿ç”¨ <code>.pick</code> .</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> JustTheName <span class="token operator">=</span> Recipe<span class="token punctuation">.</span><span class="token function">pick</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> JustTheName <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> JustTheName<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; { name: string }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>è¦åˆ é™¤æŸäº› Keyï¼Œè¯·ä½¿ç”¨ <code>.omit</code> .</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> NoIDRecipe <span class="token operator">=</span> Recipe<span class="token punctuation">.</span><span class="token function">omit</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> NoIDRecipe <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> NoIDRecipe<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; { name: string, ingredients: string[] }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="partial"><a href="#partial" class="header-anchor">#</a> <code>.partial</code></h3> <p>å— TypeScript å†…ç½®çš„å®ç”¨ç±»å‹<a href="https://www.typescriptlang.org/docs/handbook/utility-types.html#partialtype" target="_blank" rel="noopener noreferrer">Partial<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>çš„å¯å‘, <code>.partial</code> æ–¹æ³•ä½¿æ‰€æœ‰å±æ€§éƒ½æ˜¯å¯é€‰çš„ã€‚</p> <p>ä»è¿™ä¸ªå¯¹è±¡å¼€å§‹:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> user <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  username<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { username: string }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ª Partial ç‰ˆæœ¬:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> partialUser <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">partial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { username?: string | undefined }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="deeppartial"><a href="#deeppartial" class="header-anchor">#</a> <code>.deepPartial</code></h3> <p>T<code>.partial</code> åªæ˜¯ä¸€ä¸ªæµ…å±‚çš„ä½¿ç”¨ â€” å®ƒåªé€‚ç”¨äºä¸€ä¸ªå±‚æ¬¡çš„æ·±åº¦ã€‚è¿˜æœ‰ä¸€ä¸ª &quot;æ·±å±‚&quot; ç‰ˆæœ¬:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> user <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  username<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  location<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    latitude<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    longitude<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> deepPartialUser <span class="token operator">=</span> user<span class="token punctuation">.</span><span class="token function">deepPartial</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
{
  username?: string | undefined,
  location?: {
    latitude?: number | undefined;
    longitude?: number | undefined;
  } | undefined
}
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><blockquote><p>é‡è¦çš„é™åˆ¶: <code>deep partials</code> åªåœ¨å¯¹è±¡æ¨¡å¼çš„ç›´æ¥å±‚æ¬¡ä¸­æŒ‰é¢„æœŸå·¥ä½œã€‚åµŒå¥—çš„å¯¹è±¡æ¨¡å¼ä¸èƒ½æ˜¯å¯é€‰çš„ï¼Œä¸èƒ½æ˜¯ç©ºçš„ï¼Œä¸èƒ½åŒ…å«ç»†åŒ–ï¼Œä¸èƒ½åŒ…å«è½¬æ¢ï¼Œç­‰ç­‰...</p></blockquote> <h4 id="æœªè¢«è¯†åˆ«çš„-keys"><a href="#æœªè¢«è¯†åˆ«çš„-keys" class="header-anchor">#</a> æœªè¢«è¯†åˆ«çš„ keys</h4> <p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒZod å¯¹è±¡çš„æ¨¡å¼åœ¨è§£æè¿‡ç¨‹ä¸­ä¼šå‰¥ç¦»å‡ºæœªè¢«è¯†åˆ«çš„ keys</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> person <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

person<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;bob dylan&quot;</span><span class="token punctuation">,</span>
  extraKey<span class="token operator">:</span> <span class="token number">61</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; { name: &quot;bob dylan&quot; }</span>
<span class="token comment">// extraKeyå·²ç»è¢«å‰¥ç¦»</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="passthrough"><a href="#passthrough" class="header-anchor">#</a> <code>.passthrough</code></h3> <p>ç›¸åï¼Œå¦‚æœä½ æƒ³é€šè¿‡æœªçŸ¥çš„ keysï¼Œä½¿ç”¨<code>.passthrough()</code>ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>person<span class="token punctuation">.</span><span class="token function">passthrough</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;bob dylan&quot;</span><span class="token punctuation">,</span>
  extraKey<span class="token operator">:</span> <span class="token number">61</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; { name: &quot;bob dylan&quot;, extraKey: 61 }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="strict"><a href="#strict" class="header-anchor">#</a> <code>.strict</code></h3> <p>ä½ å¯ä»¥ç”¨<code>.strict()</code>æ¥ <em>ç¦æ­¢</em> æœªçŸ¥é”®ã€‚å¦‚æœè¾“å…¥ä¸­å­˜åœ¨ä»»ä½•æœªçŸ¥çš„ keysï¼ŒZod å°†æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> person <span class="token operator">=</span> z
  <span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">strict</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

person<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;bob dylan&quot;</span><span class="token punctuation">,</span>
  extraKey<span class="token operator">:</span> <span class="token number">61</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; throws ZodError</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="strip"><a href="#strip" class="header-anchor">#</a> <code>.strip</code></h3> <p>ä½ å¯ä»¥ä½¿ç”¨<code>.strip</code>æ–¹æ³•å°†ä¸€ä¸ªå¯¹è±¡æ¨¡å¼é‡ç½®ä¸ºé»˜è®¤è¡Œä¸º(å‰¥ç¦»æœªè¯†åˆ«çš„ keys)ã€‚</p> <h3 id="catchall"><a href="#catchall" class="header-anchor">#</a> <code>.catchall</code></h3> <p>ä½ å¯ä»¥å°†ä¸€ä¸ª &quot;catchall &quot;æ¨¡å¼ä¼ é€’ç»™ä¸€ä¸ªå¯¹è±¡æ¨¡å¼ã€‚æ‰€æœ‰æœªçŸ¥çš„ keys éƒ½å°†æ ¹æ®å®ƒè¿›è¡ŒéªŒè¯ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> person <span class="token operator">=</span> z
  <span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catchall</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

person<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;bob dylan&quot;</span><span class="token punctuation">,</span>
  validExtraKey<span class="token operator">:</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token comment">// è¿è¡Œè‰¯å¥½</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

person<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;bob dylan&quot;</span><span class="token punctuation">,</span>
  validExtraKey<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// æœªèƒ½æˆåŠŸ</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; throws ZodError</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>ä½¿ç”¨<code>.catchall()</code>å¯ä»¥é¿å…<code>.passthrough()</code>ï¼Œ<code>.strip()</code>ï¼Œæˆ–<code>.strict()</code>ã€‚ç°åœ¨æ‰€æœ‰çš„é”®éƒ½è¢«è§†ä¸º &quot;å·²çŸ¥(known)&quot;ã€‚</p> <h2 id="arrays"><a href="#arrays" class="header-anchor">#</a> Arrays</h2> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> stringArray <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ç›¸å½“äº</span>
<span class="token keyword">const</span> stringArray <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>è¦å°å¿ƒä½¿ç”¨<code>.array()</code>æ–¹æ³•ã€‚å®ƒè¿”å›ä¸€ä¸ªæ–°çš„<code>ZodArray</code>å®ä¾‹ã€‚è¿™æ„å‘³ç€ä½ è°ƒç”¨æ–¹æ³•çš„ <em>é¡ºåº</em> å¾ˆé‡è¦ã€‚æ¯”å¦‚è¯´:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">optional</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// (string | undefined)[]</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">optional</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string[] | undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="nonempty"><a href="#nonempty" class="header-anchor">#</a> <code>.nonempty</code></h3> <p>å¦‚æœä½ æƒ³ç¡®ä¿ä¸€ä¸ªæ•°ç»„è‡³å°‘åŒ…å«ä¸€ä¸ªå…ƒç´ ï¼Œä½¿ç”¨ <code>.nonempty()</code>.</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> nonEmptyStrings <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nonempty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ç°åœ¨æ¨æ–­çš„ç±»å‹æ˜¯</span>
<span class="token comment">// [string, ...string[]]</span>

nonEmptyStrings<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// throws: &quot;Array cannot be empty&quot;</span>
nonEmptyStrings<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;Ariana Grande&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// passes</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="min-max-length"><a href="#min-max-length" class="header-anchor">#</a> <code>.min/.max/.length</code></h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¿…é¡»åŒ…å«5ä¸ªæˆ–æ›´å¤šå…ƒç´ </span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¿…é¡»åŒ…å«5ä¸ªæˆ–æ›´å°‘å…ƒç´ </span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// å¿…é¡»æ­£å¥½åŒ…å«5ä¸ªå…ƒç´ </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ä¸<code>.nonempty()</code>ä¸åŒï¼Œè¿™äº›æ–¹æ³•ä¸ä¼šæ”¹å˜æ¨æ–­çš„ç±»å‹ã€‚</p> <h2 id="unions"><a href="#unions" class="header-anchor">#</a> Unions</h2> <p>Zod åŒ…æ‹¬ä¸€ä¸ªå†…ç½®çš„<code>z.union</code>æ–¹æ³•ï¼Œç”¨äºåˆæˆ &quot;OR&quot; ç±»å‹ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> stringOrNumber <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">union</span><span class="token punctuation">(</span><span class="token punctuation">[</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

stringOrNumber<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡</span>
stringOrNumber<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Zod å°†æŒ‰ç…§æ¯ä¸ª &quot;é€‰é¡¹&quot; çš„é¡ºåºæµ‹è¯•è¾“å…¥ï¼Œå¹¶è¿”å›ç¬¬ä¸€ä¸ªæˆåŠŸéªŒè¯çš„å€¼ã€‚</p> <p>ä¸ºäº†æ–¹ä¾¿ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨<code>.or</code>æ–¹æ³•:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> stringOrNumber <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="optionals"><a href="#optionals" class="header-anchor">#</a> Optionals</h2> <p>ä½ å¯ä»¥ç”¨<code>z.optional()</code>ä½¿ä»»ä½•æ¨¡å¼æˆä¸ºå¯é€‰:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> schema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">optional</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

schema<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; returns undefined</span>
<span class="token keyword">type</span> <span class="token constant">A</span> <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> schema<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string | undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>ä½ å¯ä»¥ç”¨<code>.optional()</code>æ–¹æ³•ä½¿ä¸€ä¸ªç°æœ‰çš„æ¨¡å¼æˆä¸ºå¯é€‰çš„:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> user <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  username<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">optional</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token constant">C</span> <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> user<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// { username?: string | undefined };</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="unwrap"><a href="#unwrap" class="header-anchor">#</a> <code>.unwrap</code></h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> stringSchema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> optionalString <span class="token operator">=</span> stringSchema<span class="token punctuation">.</span><span class="token function">optional</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
optionalString<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> stringSchema<span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="nullables"><a href="#nullables" class="header-anchor">#</a> Nullables</h2> <p>ç±»ä¼¼åœ°ï¼Œä½ å¯ä»¥è¿™æ ·åˆ›å»º nullable ç±»å‹:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> nullableString <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">nullable</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
nullableString<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;asdf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; &quot;asdf&quot;</span>
nullableString<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; null</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ä½ å¯ä»¥ç”¨<code>nullable</code>æ–¹æ³•ä½¿ä¸€ä¸ªç°æœ‰çš„æ¨¡å¼å˜æˆ nullable:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> <span class="token constant">E</span> <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// equivalent to D</span>
<span class="token keyword">type</span> <span class="token constant">E</span> <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> <span class="token constant">E</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string | null</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="unwrap-2"><a href="#unwrap-2" class="header-anchor">#</a> <code>.unwrap</code></h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> stringSchema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> nullableString <span class="token operator">=</span> stringSchema<span class="token punctuation">.</span><span class="token function">nullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
nullableString<span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> stringSchema<span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div> <h2 id="records"><a href="#records" class="header-anchor">#</a> Records</h2> <p>Record æ¨¡å¼ç”¨äºéªŒè¯è¯¸å¦‚<code>{ [k: string]: number }</code>è¿™æ ·çš„ç±»å‹ã€‚</p> <p>å¦‚æœä½ æƒ³æ ¹æ®æŸç§æ¨¡å¼éªŒè¯ä¸€ä¸ªå¯¹è±¡çš„ <em>value</em> ï¼Œä½†ä¸å…³å¿ƒ keysï¼Œä½¿ç”¨`Record'ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> NumberCache <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">record</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> NumberCache <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> NumberCache<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; { [k: string]: number }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>è¿™å¯¹äºæŒ‰ ID å­˜å‚¨æˆ–ç¼“å­˜é¡¹ç›®ç‰¹åˆ«æœ‰ç”¨ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> userSchema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> userStoreSchema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">record</span><span class="token punctuation">(</span>userSchema<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> UserStore <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> userStoreSchema<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; type UserStore = { [ x: string ]: { name: string } }</span>

<span class="token keyword">const</span> userStore<span class="token operator">:</span> UserStore <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

userStore<span class="token punctuation">[</span><span class="token string">&quot;77d2586b-9e8e-4ecf-8b21-ea7e0530eadd&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;Carlotta&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// passes</span>

userStore<span class="token punctuation">[</span><span class="token string">&quot;77d2586b-9e8e-4ecf-8b21-ea7e0530eadd&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  whatever<span class="token operator">:</span> <span class="token string">&quot;Ice cream sundae&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// TypeError</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="å…³äºæ•°å­—é”®çš„è¯´æ˜"><a href="#å…³äºæ•°å­—é”®çš„è¯´æ˜" class="header-anchor">#</a> å…³äºæ•°å­—é”®çš„è¯´æ˜</h4> <p>ä½ å¯èƒ½æœŸæœ›<code>z.record()</code>æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ keyï¼Œä¸€ä¸ªæ˜¯ valueã€‚æ¯•ç«Ÿï¼ŒTypeScript çš„å†…ç½® Record ç±»å‹æ˜¯è¿™æ ·çš„ï¼š<code>Record&lt;KeyType, ValueType&gt;</code> ã€‚å¦åˆ™ï¼Œä½ å¦‚ä½•åœ¨ Zod ä¸­è¡¨ç¤º TypeScript ç±»å‹<code>Record&lt;number, any&gt;</code>ï¼Ÿ</p> <p>äº‹å®è¯æ˜ï¼ŒTypeScript å›´ç»•<code>[k: number]</code>çš„è¡Œä¸ºæœ‰ç‚¹ä¸ç›´è§‚:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> testMap<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>k<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token number">1</span><span class="token operator">:</span> <span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> testMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">typeof</span> key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// prints: `1: string`</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼ŒJavaScript ä¼šè‡ªåŠ¨å°†æ‰€æœ‰å¯¹è±¡ key è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚</p> <p>ç”±äº Zod è¯•å›¾å¼¥åˆé™æ€ç±»å‹å’Œè¿è¡Œæ—¶ç±»å‹ä¹‹é—´çš„å·®è·ï¼Œæä¾›ä¸€ç§åˆ›å»ºå¸¦æœ‰æ•°å­—é”®çš„è®°å½•æ¨¡å¼çš„æ–¹æ³•æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºåœ¨ JavaScript runtime ä¸­æ²¡æœ‰æ•°å­—é”®è¿™å›äº‹ã€‚</p> <h2 id="maps"><a href="#maps" class="header-anchor">#</a> Maps</h2> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> stringNumberMap <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> StringNumberMap <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> stringNumberMap<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token comment">// type StringNumber = Map&lt;string, number&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="sets"><a href="#sets" class="header-anchor">#</a> Sets</h2> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> numberSet <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> numberSet <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> numberSet<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token comment">// Set&lt;number&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="enums"><a href="#enums" class="header-anchor">#</a> Enums</h2> <p>åœ¨ Zod ä¸­ï¼Œæœ‰ä¸¤ç§æ–¹æ³•æ¥å®šä¹‰æšä¸¾ã€‚</p> <h3 id="zod-enums"><a href="#zod-enums" class="header-anchor">#</a> Zod enums</h3> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> FishEnum <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token keyword">enum</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;Salmon&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Tuna&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Trout&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> FishEnum <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> FishEnum<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token comment">// 'Salmon' | 'Tuna' | 'Trout'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ä½ å¿…é¡»å°†æ•°å€¼æ•°ç»„ç›´æ¥ä¼ å…¥<code>z.enum()</code>ã€‚è¿™æ ·åšæ˜¯ä¸è¡Œçš„:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> fish <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;Salmon&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Tuna&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Trout&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> FishEnum <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token keyword">enum</span><span class="token punctuation">(</span>fish<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒZod æ— æ³•æ¨æ–­å‡ºå„ä¸ªæšä¸¾å…ƒç´ ï¼›ç›¸åï¼Œæ¨æ–­å‡ºçš„ç±»å‹å°†æ˜¯ <code>string</code> è€Œä¸æ˜¯<code>'Salmon'|'Tuna'|'Trout'</code>ã€‚</p> <p>å¦ä¸€ç§å¯è¡Œçš„æ–¹å¼æ˜¯ä½¿ç”¨<code>as const</code>ï¼Œè¿™æ · Zod å°±å¯ä»¥æ¨æ–­å‡ºæ­£ç¡®çš„ç±»å‹ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> <span class="token constant">VALUES</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;Salmon&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Tuna&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Trout&quot;</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> FishEnum <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token keyword">enum</span><span class="token punctuation">(</span><span class="token constant">VALUES</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>è‡ªåŠ¨è¡¥å…¨</strong></p> <p>ä¸ºäº†è·å¾— Zod æšä¸¾çš„è‡ªåŠ¨å®Œæˆï¼Œè¯·ä½¿ç”¨ä½ çš„æ¨¡å¼çš„<code>.enum</code>å±æ€§:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>FishEnum<span class="token punctuation">.</span><span class="token keyword">enum</span><span class="token punctuation">.</span>Salmon<span class="token punctuation">;</span> <span class="token comment">// =&gt; è‡ªåŠ¨è¡¥å…¨</span>

FishEnum<span class="token punctuation">.</span><span class="token keyword">enum</span><span class="token punctuation">;</span>
<span class="token comment">/*
=&gt; {
  Salmon: &quot;Salmon&quot;,
  Tuna: &quot;Tuna&quot;,
  Trout: &quot;Trout&quot;,
}
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>ä½ ä¹Ÿå¯ä»¥ç”¨<code>.options</code>å±æ€§æ£€ç´¢é€‰é¡¹åˆ—è¡¨ï¼Œä½œä¸ºä¸€ä¸ªå…ƒç»„:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>FishEnum<span class="token punctuation">.</span>options<span class="token punctuation">;</span> <span class="token comment">// [&quot;Salmon&quot;, &quot;Tuna&quot;, &quot;Trout&quot;]);</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="native-enums"><a href="#native-enums" class="header-anchor">#</a> Native enums</h3> <p>Zod æšä¸¾æ˜¯å®šä¹‰å’ŒéªŒè¯æšä¸¾çš„æ¨èæ–¹æ³•ã€‚ä½†æ˜¯å¦‚æœä½ éœ€è¦å¯¹ç¬¬ä¸‰æ–¹åº“çš„æšä¸¾è¿›è¡ŒéªŒè¯ï¼ˆæˆ–è€…ä½ ä¸æƒ³é‡å†™ä½ ç°æœ‰çš„æšä¸¾ï¼‰ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>z.nativeEnum()</code>ã€‚</p> <p><strong>æ•°å­—æšä¸¾</strong></p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">enum</span> Fruits <span class="token punctuation">{</span>
  Apple<span class="token punctuation">,</span>
  Banana<span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> FruitEnum <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">nativeEnum</span><span class="token punctuation">(</span>Fruits<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> FruitEnum <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> FruitEnum<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// Fruits</span>

FruitEnum<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>Fruits<span class="token punctuation">.</span>Apple<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡</span>
FruitEnum<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>Fruits<span class="token punctuation">.</span>Banana<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡</span>
FruitEnum<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡</span>
FruitEnum<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡</span>
FruitEnum<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æœªé€šè¿‡</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>String enums</strong></p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">enum</span> Fruits <span class="token punctuation">{</span>
  Apple <span class="token operator">=</span> <span class="token string">&quot;apple&quot;</span><span class="token punctuation">,</span>
  Banana <span class="token operator">=</span> <span class="token string">&quot;banana&quot;</span><span class="token punctuation">,</span>
  Cantaloupe<span class="token punctuation">,</span> <span class="token comment">// ä½ å¯ä»¥æ··åˆä½¿ç”¨æ•°å­—å’Œå­—ç¬¦ä¸²çš„æšä¸¾</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> FruitEnum <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">nativeEnum</span><span class="token punctuation">(</span>Fruits<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> FruitEnum <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> FruitEnum<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// Fruits</span>

FruitEnum<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>Fruits<span class="token punctuation">.</span>Apple<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡</span>
FruitEnum<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>Fruits<span class="token punctuation">.</span>Cantaloupe<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡</span>
FruitEnum<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;apple&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡</span>
FruitEnum<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;banana&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡</span>
FruitEnum<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡</span>
FruitEnum<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;Cantaloupe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æœªé€šè¿‡</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>å¸¸é‡æšä¸¾</strong></p> <p><code>.nativeEnum()</code>å‡½æ•°ä¹Ÿé€‚ç”¨äº<code>as const</code>å¯¹è±¡ã€‚ âš ï¸ <code>as const</code>éœ€è¦ TypeScript 3.4+!</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> Fruits <span class="token operator">=</span> <span class="token punctuation">{</span>
  Apple<span class="token operator">:</span> <span class="token string">&quot;apple&quot;</span><span class="token punctuation">,</span>
  Banana<span class="token operator">:</span> <span class="token string">&quot;banana&quot;</span><span class="token punctuation">,</span>
  Cantaloupe<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">as</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> FruitEnum <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">nativeEnum</span><span class="token punctuation">(</span>Fruits<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> FruitEnum <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> FruitEnum<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// &quot;apple&quot; | &quot;banana&quot; | 3</span>

FruitEnum<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;apple&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// passes</span>
FruitEnum<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;banana&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// passes</span>
FruitEnum<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// passes</span>
FruitEnum<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;Cantaloupe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// fails</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="intersections"><a href="#intersections" class="header-anchor">#</a> Intersections</h2> <p>äº¤å‰ç±»å‹å¯¹äºåˆ›å»º &quot;logical AND&quot;ç±»å‹å¾ˆæœ‰ç”¨ã€‚è¿™å¯¹äºä¸¤ä¸ªå¯¹è±¡ç±»å‹çš„ç›¸äº¤å¾ˆæœ‰ç”¨ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> Person <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> Employee <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  role<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> EmployedPerson <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">intersection</span><span class="token punctuation">(</span>Person<span class="token punctuation">,</span> Employee<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// equivalent to:</span>
<span class="token keyword">const</span> EmployedPerson <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>Employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>è™½ç„¶åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå»ºè®®ä½¿ç”¨<code>A.merge(B)</code>æ¥åˆå¹¶ä¸¤ä¸ªå¯¹è±¡ã€‚<code>.merge</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„<code>ZodObject</code>å®ä¾‹ï¼Œè€Œ<code>A.and(B)</code>è¿”å›ä¸€ä¸ªä¸å¤ªæœ‰ç”¨çš„<code>ZodIntersection</code>å®ä¾‹ï¼Œå®ƒç¼ºä¹åƒ<code>pick</code>å’Œ<code>omit</code>è¿™æ ·çš„å¸¸ç”¨å¯¹è±¡æ–¹æ³•ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> a <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">union</span><span class="token punctuation">(</span><span class="token punctuation">[</span>z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">union</span><span class="token punctuation">(</span><span class="token punctuation">[</span>z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> z<span class="token punctuation">.</span><span class="token function">boolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> c <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">intersection</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> c <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> c<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; number</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div> <h2 id="tuples"><a href="#tuples" class="header-anchor">#</a> Tuples</h2> <p>ä¸æ•°ç»„ä¸åŒï¼Œtuples æœ‰å›ºå®šæ•°é‡çš„å…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ å¯ä»¥æœ‰ä¸åŒçš„ç±»å‹ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> athleteSchema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">tuple</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// name</span>
  z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// jersey number</span>
  z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    pointsScored<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// statistics</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> Athlete <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> athleteSchema<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token comment">// type Athlete = [string, number, { pointsScored: number }]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="recursive-types"><a href="#recursive-types" class="header-anchor">#</a> Recursive types</h2> <p>ä½ å¯ä»¥åœ¨ Zod ä¸­å®šä¹‰ä¸€ä¸ªé€’å½’æ¨¡å¼ï¼Œä½†ç”±äº TypeScript çš„é™åˆ¶ï¼Œå®ƒä»¬çš„ç±»å‹ä¸èƒ½è¢«é™æ€æ¨æ–­ã€‚ç›¸åï¼Œä½ éœ€è¦æ‰‹åŠ¨å®šä¹‰ç±»å‹ï¼Œå¹¶å°†å…¶ä½œä¸º &quot;ç±»å‹æç¤º&quot; æä¾›ç»™ Zodã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">Category</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  subcategories<span class="token operator">:</span> Category<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// cast to z.ZodSchema&lt;Category&gt;</span>
<span class="token keyword">const</span> Category<span class="token operator">:</span> z<span class="token punctuation">.</span>ZodSchema<span class="token operator">&lt;</span>Category<span class="token operator">&gt;</span> <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    subcategories<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span>Category<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

Category<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;People&quot;</span><span class="token punctuation">,</span>
  subcategories<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&quot;Politicians&quot;</span><span class="token punctuation">,</span>
      subcategories<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;Presidents&quot;</span><span class="token punctuation">,</span> subcategories<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// é€šè¿‡</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>ä¸å¹¸çš„æ˜¯ï¼Œè¿™æ®µä»£ç æœ‰ç‚¹é‡å¤ï¼Œå› ä¸ºä½ å£°æ˜äº†ä¸¤æ¬¡ç±»å‹ï¼šä¸€æ¬¡åœ¨æ¥å£ä¸­ï¼Œå¦ä¸€æ¬¡åœ¨ Zod å®šä¹‰ä¸­ã€‚</p> <h4 id="json-type"><a href="#json-type" class="header-anchor">#</a> JSON type</h4> <p>å¦‚æœä½ æƒ³éªŒè¯ä»»ä½• JSON å€¼ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ç‰‡æ®µã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> literalSchema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">union</span><span class="token punctuation">(</span><span class="token punctuation">[</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> z<span class="token punctuation">.</span><span class="token function">boolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> z<span class="token punctuation">.</span><span class="token keyword">null</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> Literal <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> literalSchema<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> Json <span class="token operator">=</span> Literal <span class="token operator">|</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> Json <span class="token punctuation">}</span> <span class="token operator">|</span> Json<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> jsonSchema<span class="token operator">:</span> z<span class="token punctuation">.</span>ZodSchema<span class="token operator">&lt;</span>Json<span class="token operator">&gt;</span> <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  z<span class="token punctuation">.</span><span class="token function">union</span><span class="token punctuation">(</span><span class="token punctuation">[</span>literalSchema<span class="token punctuation">,</span> z<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span>jsonSchema<span class="token punctuation">)</span><span class="token punctuation">,</span> z<span class="token punctuation">.</span><span class="token function">record</span><span class="token punctuation">(</span>jsonSchema<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

jsonSchema<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="cyclical-objects"><a href="#cyclical-objects" class="header-anchor">#</a> Cyclical objects</h4> <p>å°½ç®¡æ”¯æŒé€’å½’æ¨¡å¼ï¼Œä½†å°†ä¸€ä¸ªå¾ªç¯æ•°æ®ä¼ å…¥ Zod ä¼šå¯¼è‡´æ— é™å¾ªç¯ã€‚</p> <h2 id="promises"><a href="#promises" class="header-anchor">#</a> Promises</h2> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> numberPromise <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">promise</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>&quot;Parsing&quot;çš„å·¥ä½œæ–¹å¼ä¸ promise æ¨¡å¼æœ‰ç‚¹ä¸åŒã€‚éªŒè¯åˆ†ä¸¤éƒ¨åˆ†è¿›è¡Œ:</p> <ol><li>Zod åŒæ­¥æ£€æŸ¥è¾“å…¥æ˜¯å¦æ˜¯ Promise çš„å®ä¾‹(å³ä¸€ä¸ªå…·æœ‰<code>.then</code>å’Œ<code>.catch</code>æ–¹æ³•çš„å¯¹è±¡)ã€‚</li> <li>Zod ä½¿ç”¨<code>.then</code>åœ¨ç°æœ‰çš„ Promise ä¸Šé™„åŠ ä¸€ä¸ªé¢å¤–çš„éªŒè¯æ­¥éª¤ã€‚ä½ å¿…é¡»åœ¨è¿”å›çš„ Promise ä¸Šä½¿ç”¨<code>.catch</code>æ¥å¤„ç†éªŒè¯å¤±è´¥çš„é—®é¢˜ã€‚</li></ol> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>numberPromise<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;tuna&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ZodError: Non-Promise type: string</span>

numberPromise<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;tuna&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; Promise&lt;number&gt;</span>

<span class="token keyword">const</span> <span class="token function-variable function">test</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> numberPromise<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&quot;tuna&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ZodError: Non-number type: string</span>

  <span class="token keyword">await</span> numberPromise<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">3.14</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// =&gt; 3.14</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div> <h2 id="instanceof"><a href="#instanceof" class="header-anchor">#</a> Instanceof</h2> <p>ä½ å¯ä»¥ä½¿ç”¨<code>z.instanceof</code>æ¥æ£€æŸ¥è¾“å…¥æ˜¯å¦æ˜¯ä¸€ä¸ªç±»çš„å®ä¾‹ã€‚è¿™å¯¹äºéªŒè¯ä»ç¬¬ä¸‰æ–¹åº“ä¸­å¯¼å‡ºçš„ç±»çš„è¾“å…¥å¾ˆæœ‰ç”¨ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">class</span> <span class="token class-name">Test</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> TestSchema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token keyword">instanceof</span><span class="token punctuation">(</span>Test<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> blob<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token string">&quot;whatever&quot;</span><span class="token punctuation">;</span>
TestSchema<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// passes</span>
TestSchema<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;blob&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// throws</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="function-schemas"><a href="#function-schemas" class="header-anchor">#</a> Function schemas</h2> <p>Zod è¿˜å…è®¸ä½ å®šä¹‰ &quot;å‡½æ•°æ¨¡å¼(function schemas)&quot;ã€‚è¿™ä½¿å¾—éªŒè¯ä¸€ä¸ªå‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºå˜å¾—å¾ˆå®¹æ˜“ï¼Œè€Œä¸éœ€è¦æŠŠéªŒè¯ä»£ç å’Œ &quot;ä¸šåŠ¡é€»è¾‘(business logic)&quot;æ··åœ¨ä¸€èµ·ã€‚</p> <p>ä½ å¯ä»¥ç”¨<code>z.function(args, returnType)</code>åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¨¡å¼ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> myFunction <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> myFunction <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> myFunction<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; ()=&gt;unknown</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>å®šä¹‰è¾“å…¥å’Œè¾“å‡º</strong></p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> myFunction <span class="token operator">=</span> z
  <span class="token punctuation">.</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">args</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// æ¥å—ä»»æ„æ•°é‡çš„å‚æ•°</span>
  <span class="token punctuation">.</span><span class="token function">returns</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">boolean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> myFunction <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> myFunction<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; (arg0: string, arg1: number)=&gt;boolean</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>æå–è¾“å…¥å’Œè¾“å‡ºæ¨¡å¼</strong>
ä½ å¯ä»¥æå–ä¸€ä¸ªå‡½æ•°æ¨¡å¼çš„å‚æ•°å’Œè¿”å›ç±»å‹ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>myFunction<span class="token punctuation">.</span><span class="token function">parameters</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; ZodTuple&lt;[ZodString, ZodNumber]&gt;</span>

myFunction<span class="token punctuation">.</span><span class="token function">returnType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; ZodBoolean</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>å‡½æ•°æ¨¡å¼æœ‰ä¸€ä¸ª<code>.implement()</code>æ–¹æ³•ï¼Œå®ƒæ¥å—ä¸€ä¸ªå‡½æ•°å¹¶è¿”å›ä¸€ä¸ªè‡ªåŠ¨éªŒè¯å…¶è¾“å…¥å’Œè¾“å‡ºçš„æ–°å‡½æ•°ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> trimmedLength <span class="token operator">=</span> z
  <span class="token punctuation">.</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">args</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// accepts an arbitrary number of arguments</span>
  <span class="token punctuation">.</span><span class="token function">returns</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">implement</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// TypeScript knows x is a string!</span>
    <span class="token keyword">return</span> x<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">trimmedLength</span><span class="token punctuation">(</span><span class="token string">&quot;sandwich&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; 8</span>
<span class="token function">trimmedLength</span><span class="token punctuation">(</span><span class="token string">&quot; asdf &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; 4</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>å¦‚æœä½ åªå…³å¿ƒéªŒè¯è¾“å…¥ï¼Œé‚£å°±å¥½äº†:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> myFunction <span class="token operator">=</span> z
  <span class="token punctuation">.</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">args</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">implement</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>arg<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myFunction<span class="token punctuation">;</span> <span class="token comment">// (arg: string)=&gt;number[]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h1 id="zodtype-methods-and-properties"><a href="#zodtype-methods-and-properties" class="header-anchor">#</a> ZodType: methods and properties</h1> <p>æ‰€æœ‰çš„ Zod æ¨¡å¼éƒ½åŒ…å«ä¸€äº›æ–¹æ³•ã€‚</p> <h3 id="parse"><a href="#parse" class="header-anchor">#</a> <code>.parse</code></h3> <p><code>.parse(data:unknown): T</code></p> <p>ç»™å®šä»»ä½• Zod æ¨¡å¼ï¼Œä½ å¯ä»¥è°ƒç”¨å…¶<code>.parse</code>æ–¹æ³•æ¥æ£€æŸ¥<code>data</code>æ˜¯å¦æœ‰æ•ˆã€‚å¦‚æœæ˜¯çš„è¯ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªå¸¦æœ‰å®Œæ•´ç±»å‹ä¿¡æ¯çš„å€¼ã€‚å¦åˆ™ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯ã€‚</p> <blockquote><p>IMPORTANT: åœ¨ Zod 2 å’Œ Zod 1.11+ä¸­ï¼Œ<code>.parse</code>è¿”å›çš„å€¼æ˜¯ä½ ä¼ å…¥çš„å˜é‡çš„ <em>deep clone</em> ã€‚è¿™åœ¨zod@1.4 å’Œæ›´æ—©çš„ç‰ˆæœ¬ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚</p></blockquote> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> stringSchema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
stringSchema<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;fish&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; returns &quot;fish&quot;</span>
stringSchema<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// throws Error('Non-string type: number');</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="parseasync"><a href="#parseasync" class="header-anchor">#</a> <code>.parseAsync</code></h3> <p><code>.parseAsync(data:unknown): Promise&lt;T&gt;</code></p> <p>å¦‚æœä½ ä½¿ç”¨å¼‚æ­¥çš„<a href="#refine">refinements</a>æˆ–<a href="#transform">transforms</a>ï¼ˆåé¢ä¼šæœ‰æ›´å¤šä»‹ç»ï¼‰ï¼Œä½ éœ€è¦ä½¿ç”¨<code>.parseAsync</code></p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> stringSchema <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">refine</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> val<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token keyword">await</span> stringSchema<span class="token punctuation">.</span><span class="token function">parseAsync</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; hello</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="safeparse"><a href="#safeparse" class="header-anchor">#</a> <code>.safeParse</code></h3> <p><code>.safeParse(data:unknown): { success: true; data: T; } | { success: false; error: ZodError; }</code></p> <p>å¦‚æœä½ ä¸å¸Œæœ› Zod åœ¨éªŒè¯å¤±è´¥æ—¶æŠ›å‡ºé”™è¯¯ï¼Œè¯·ä½¿ç”¨<code>.safeParse</code>ã€‚è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«æˆåŠŸè§£æçš„æ•°æ®çš„å¯¹è±¡ï¼Œæˆ–è€…ä¸€ä¸ªåŒ…å«éªŒè¯é—®é¢˜è¯¦ç»†ä¿¡æ¯çš„ ZodError å®ä¾‹ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>stringSchema<span class="token punctuation">.</span><span class="token function">safeParse</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; { success: false; error: ZodError }</span>

stringSchema<span class="token punctuation">.</span><span class="token function">safeParse</span><span class="token punctuation">(</span><span class="token string">&quot;billie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// =&gt; { success: true; data: 'billie' }</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>ç»“æœæ˜¯ä¸€ä¸ª <em>discriminated union</em> ï¼Œæ‰€ä»¥ä½ å¯ä»¥éå¸¸æ–¹ä¾¿åœ°å¤„ç†é”™è¯¯:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> result <span class="token operator">=</span> stringSchema<span class="token punctuation">.</span><span class="token function">safeParse</span><span class="token punctuation">(</span><span class="token string">&quot;billie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// handle error then return</span>
  result<span class="token punctuation">.</span>error<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// do something</span>
  result<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="safeparseasync"><a href="#safeparseasync" class="header-anchor">#</a> <code>.safeParseAsync</code></h3> <blockquote><p>Alias: <code>.spa</code></p></blockquote> <p>ä¸€ä¸ªå¼‚æ­¥ç‰ˆæœ¬çš„<code>safeParse</code>ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">await</span> stringSchema<span class="token punctuation">.</span><span class="token function">safeParseAsync</span><span class="token punctuation">(</span><span class="token string">&quot;billie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä¸ºæ–¹ä¾¿èµ·è§ï¼Œå®ƒå·²è¢«åˆ«åä¸º<code>.spa</code>:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">await</span> stringSchema<span class="token punctuation">.</span><span class="token function">spa</span><span class="token punctuation">(</span><span class="token string">&quot;billie&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="refine"><a href="#refine" class="header-anchor">#</a> <code>.refine</code></h3> <p><code>.refine(validator: (data:T)=&gt;any, params?: RefineParams)</code></p> <p>Zod å…è®¸ä½ é€šè¿‡ <em>refinements</em> æä¾›è‡ªå®šä¹‰éªŒè¯é€»è¾‘ã€‚(å…³äºåˆ›å»ºå¤šä¸ªé—®é¢˜å’Œè‡ªå®šä¹‰é”™è¯¯ä»£ç ç­‰é«˜çº§åŠŸèƒ½ï¼Œè§<a href="#superrefine"><code>.superRefine</code></a>)ã€‚</p> <p>Zod è¢«è®¾è®¡ä¸ºå°½å¯èƒ½åœ°åæ˜  TypeScriptã€‚ä½†æœ‰è®¸å¤šæ‰€è°“çš„ &quot;ç»†åŒ–ç±»å‹&quot;ï¼Œä½ å¯èƒ½å¸Œæœ›æ£€æŸ¥ä¸èƒ½åœ¨ TypeScript çš„ç±»å‹ç³»ç»Ÿä¸­è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼šæ£€æŸ¥ä¸€ä¸ªæ•°å­—æ˜¯å¦æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œæˆ–è€…ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ç”µå­é‚®ä»¶åœ°å€ã€‚</p> <p>ä¾‹å¦‚ï¼Œä½ å¯ä»¥ç”¨<code>.refine</code>å¯¹ä»»ä½• Zod æ¨¡å¼å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰éªŒè¯æ£€æŸ¥:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> myString <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">refine</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> val<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  message<span class="token operator">:</span> <span class="token string">&quot;String can't be more than 255 characters&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>âš ï¸ ç²¾ç»†åŒ–å‡½æ•°ä¸åº”è¯¥æŠ›å‡ºã€‚ç›¸åï¼Œå®ƒä»¬åº”è¯¥è¿”å›ä¸€ä¸ªè™šå‡çš„å€¼æ¥è¡¨ç¤ºå¤±è´¥ã€‚</p></blockquote> <h4 id="arguments"><a href="#arguments" class="header-anchor">#</a> Arguments</h4> <p>æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œ<code>.refine</code>éœ€è¦ä¸¤ä¸ªå‚æ•°ã€‚</p> <ol><li>ç¬¬ä¸€ä¸ªæ˜¯éªŒè¯å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°æ¥å—ä¸€ä¸ªè¾“å…¥ï¼ˆç±»å‹ä¸º<code>T</code>--æ¨¡å¼çš„æ¨æ–­ç±»å‹ï¼‰å¹¶è¿”å›<code>any</code>ã€‚ä»»ä½•çœŸå®çš„å€¼éƒ½ä¼šé€šè¿‡éªŒè¯ã€‚(åœ¨zod@1.6.2 ä¹‹å‰ï¼ŒéªŒè¯å‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚)</li> <li>ç¬¬äºŒä¸ªå‚æ•°æ¥å—ä¸€äº›é€‰é¡¹ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥å®šåˆ¶æŸäº›é”™è¯¯å¤„ç†è¡Œä¸º:</li></ol> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">type</span> RefineParams <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// è¦†ç›–é”™è¯¯ä¿¡æ¯</span>
  message<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token comment">// é™„åŠ åˆ°é”™è¯¯è·¯å¾„ä¸­</span>
  path<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment">// paramså¯¹è±¡ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥å®šåˆ¶æ¶ˆæ¯</span>
  <span class="token comment">// åœ¨é”™è¯¯mapä¸­</span>
  params<span class="token operator">?</span><span class="token operator">:</span> object<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>å¯¹äºé«˜çº§æƒ…å†µï¼Œç¬¬äºŒä¸ªå‚æ•°ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¿”å›<code>RefineParams</code>çš„å‡½æ•°</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">refine</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> val<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>val<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is not more than 10 characters</span><span class="token template-punctuation string">`</span></span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="customize-error-path"><a href="#customize-error-path" class="header-anchor">#</a> Customize error path</h4> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> passwordForm <span class="token operator">=</span> z
  <span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    password<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    confirm<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">refine</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> data<span class="token punctuation">.</span>password <span class="token operator">===</span> data<span class="token punctuation">.</span>confirm<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    message<span class="token operator">:</span> <span class="token string">&quot;Passwords don't match&quot;</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;confirm&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// path of error</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">{</span> password<span class="token operator">:</span> <span class="token string">&quot;asdf&quot;</span><span class="token punctuation">,</span> confirm<span class="token operator">:</span> <span class="token string">&quot;qwer&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>å› ä¸ºä½ æä¾›äº†ä¸€ä¸ª<code>è·¯å¾„(path)</code>å‚æ•°ï¼Œäº§ç”Ÿçš„é”™è¯¯å°†æ˜¯:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>ZodError <span class="token punctuation">{</span>
  issues<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token string">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;custom&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;path&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;confirm&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Passwords don't match&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="asynchronous-refinements"><a href="#asynchronous-refinements" class="header-anchor">#</a> Asynchronous refinements</h4> <p>ç»†åŒ–ä¹Ÿå¯ä»¥æ˜¯å¼‚æ­¥çš„:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> userId <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">refine</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// verify that ID exists in database</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>âš ï¸ å¦‚æœä½ ä½¿ç”¨å¼‚æ­¥ç»†åŒ–ï¼Œä½ å¿…é¡»ä½¿ç”¨<code>.parseAsync</code>æ–¹æ³•æ¥è§£ææ•°æ®! å¦åˆ™ Zod ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p></blockquote> <h4 id="relationship-to-transforms"><a href="#relationship-to-transforms" class="header-anchor">#</a> Relationship to transforms</h4> <p>å˜æ¢(transforms)å’Œç»†åŒ–(refinements)å¯ä»¥äº¤é”™è¿›è¡Œ:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> val<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">refine</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> val <span class="token operator">&gt;</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="superrefine"><a href="#superrefine" class="header-anchor">#</a> <code>.superRefine</code></h3> <p><code>.refine</code>æ–¹æ³•å®é™…ä¸Šæ˜¯åœ¨ä¸€ä¸ªæ›´é€šç”¨çš„ï¼ˆä¹Ÿæ›´å•°å—¦ï¼‰çš„<code>superRefine</code>æ–¹æ³•ä¹‹ä¸Šçš„è¯­æ³•ç³–ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> Strings <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">superRefine</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">addIssue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      code<span class="token operator">:</span> z<span class="token punctuation">.</span>ZodIssueCode<span class="token punctuation">.</span>too_big<span class="token punctuation">,</span>
      maximum<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">&quot;array&quot;</span><span class="token punctuation">,</span>
      inclusive<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      message<span class="token operator">:</span> <span class="token string">&quot;Too many items ğŸ˜¡&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">.</span>length <span class="token operator">!==</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">addIssue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      code<span class="token operator">:</span> z<span class="token punctuation">.</span>ZodIssueCode<span class="token punctuation">.</span>custom<span class="token punctuation">,</span>
      message<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">No duplicated allowed.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>ä½ å¯ä»¥éšå¿ƒæ‰€æ¬²åœ°æ·»åŠ é—®é¢˜(issues)ã€‚å¦‚æœ<code>ctx.addIssue</code>åœ¨å‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹ä¸­æ²¡æœ‰è¢«è°ƒç”¨ï¼Œåˆ™éªŒè¯é€šè¿‡ã€‚</p> <p>é€šå¸¸æƒ…å†µä¸‹ï¼Œç»†åŒ–æ€»æ˜¯åˆ›å»ºå…·æœ‰<code>ZodIssueCode.custom</code>é”™è¯¯ä»£ç çš„é—®é¢˜ï¼Œä½†é€šè¿‡<code>superRefine</code>ä½ å¯ä»¥åˆ›å»ºä»»ä½•ä»£ç çš„ä»»ä½•é—®é¢˜ã€‚æ¯ä¸ªé—®é¢˜ä»£ç åœ¨é”™è¯¯å¤„ç†æŒ‡å— <a href="/front/js/ERROR_HANDLING.html">ERROR_HANDLING.md</a> ä¸­éƒ½æœ‰è¯¦ç»†æè¿°ã€‚</p> <h3 id="transform"><a href="#transform" class="header-anchor">#</a> <code>.transform</code></h3> <p>è¦åœ¨è§£æåè½¬æ¢æ•°æ®ï¼Œè¯·ä½¿ç”¨<code>transform</code>æ–¹æ³•ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> stringToNumber <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> myString<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
stringToNumber<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; 6</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><blockquote><p>âš ï¸ è½¬åŒ–å‡½æ•°ä¸å¾—æŠ›å‡ºã€‚ç¡®ä¿åœ¨è½¬åŒ–å™¨ä¹‹å‰ä½¿ç”¨ç»†åŒ–åŠŸèƒ½ï¼Œä»¥ç¡®ä¿è¾“å…¥å¯ä»¥è¢«è½¬åŒ–å™¨è§£æã€‚</p></blockquote> <h4 id="chaining-order"><a href="#chaining-order" class="header-anchor">#</a> Chaining order</h4> <p>æ³¨æ„ï¼Œä¸Šé¢çš„<code>stringToNumber</code>æ˜¯<code>ZodEffects</code>å­ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚å®ƒä¸æ˜¯<code>ZodString</code>çš„å®ä¾‹ã€‚å¦‚æœä½ æƒ³ä½¿ç”¨<code>ZodString</code>çš„å†…ç½®æ–¹æ³•ï¼ˆä¾‹å¦‚<code>.email()</code>ï¼‰ï¼Œä½ å¿…é¡»åœ¨è¿›è¡Œä»»ä½•è½¬æ¢ <em>ä¹‹å‰</em> åº”ç”¨è¿™äº›æ–¹æ³•ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> emailToDomain <span class="token operator">=</span> z
  <span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">email</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> val<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;@&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

emailToDomain<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;colinhacks@example.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; example.com</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="relationship-to-refinements"><a href="#relationship-to-refinements" class="header-anchor">#</a> Relationship to refinements</h4> <p>è½¬æ¢å’Œç»†åŒ–å¯ä»¥äº¤é”™è¿›è¡Œ:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> val<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">refine</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> val <span class="token operator">&gt;</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="async-transformations"><a href="#async-transformations" class="header-anchor">#</a> Async transformations</h4> <p>è½¬æ¢ä¹Ÿå¯ä»¥æ˜¯å¼‚æ­¥çš„ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> IdToUser <span class="token operator">=</span> z
  <span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token function">getUserById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>âš ï¸ å¦‚æœä½ çš„æ¨¡å¼åŒ…å«å¼‚æ­¥å˜æ¢å™¨ï¼Œä½ å¿…é¡»ä½¿ç”¨.parseAsync()æˆ–.safeParseAsync()æ¥è§£ææ•°æ®ã€‚å¦åˆ™ï¼ŒZod å°†æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p></blockquote> <h3 id="default"><a href="#default" class="header-anchor">#</a> <code>.default</code></h3> <p>ä½ å¯ä»¥ä½¿ç”¨å˜æ¢å™¨æ¥å®ç° Zod ä¸­ &quot;é»˜è®¤å€¼ &quot;çš„æ¦‚å¿µã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> stringWithDefault <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">(</span><span class="token string">&quot;tuna&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

stringWithDefault<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; &quot;tuna&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ä½ å¯ä»¥é€‰æ‹©åœ¨<code>.default</code>ä¸­ä¼ é€’ä¸€ä¸ªå‡½æ•°ï¼Œå½“éœ€è¦ç”Ÿæˆé»˜è®¤å€¼æ—¶ï¼Œè¯¥å‡½æ•°å°†è¢«é‡æ–°æ‰§è¡Œ:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> numberWithRandomDefault <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span>random<span class="token punctuation">)</span><span class="token punctuation">;</span>

numberWithRandomDefault<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; 0.4413456736055323</span>
numberWithRandomDefault<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; 0.1871840107401901</span>
numberWithRandomDefault<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// =&gt; 0.7223408162401552</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="optional"><a href="#optional" class="header-anchor">#</a> <code>.optional</code></h3> <p>ä¸€ä¸ªæ–¹ä¾¿çš„æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ¨¡å¼çš„å¯é€‰ç‰ˆæœ¬ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> optionalString <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">optional</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string | undefined</span>

<span class="token comment">// equivalent to</span>
z<span class="token punctuation">.</span><span class="token function">optional</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="nullable"><a href="#nullable" class="header-anchor">#</a> <code>.nullable</code></h3> <p>ä¸€ä¸ªæ–¹ä¾¿çš„æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ¨¡å¼çš„å¯ç©ºç‰ˆæœ¬ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> nullableString <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string | null</span>

<span class="token comment">// equivalent to</span>
z<span class="token punctuation">.</span><span class="token function">nullable</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="nullish"><a href="#nullish" class="header-anchor">#</a> <code>.nullish</code></h3> <p>ä¸€ä¸ªæ–¹ä¾¿çš„æ–¹æ³•ï¼Œç”¨äºè¿”å›æ¨¡å¼çš„ &quot;nullish &quot;ç‰ˆæœ¬ã€‚ç©ºç™½æ¨¡å¼å°†åŒæ—¶æ¥å—<code>undefined</code>å’Œ<code>null</code>ã€‚é˜…è¯»æ›´å¤šå…³äº &quot;nullish &quot;çš„æ¦‚å¿µ<a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html#nullish-coalescing" target="_blank" rel="noopener noreferrer">è¿™é‡Œ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> nullishString <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nullish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string | null | undefined</span>

<span class="token comment">// equivalent to</span>
z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nullable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">optional</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="array"><a href="#array" class="header-anchor">#</a> <code>.array</code></h3> <p>ä¸€ä¸ªæ–¹ä¾¿çš„æ–¹æ³•ï¼Œä¸ºç»™å®šç±»å‹è¿”å›ä¸€ä¸ªæ•°ç»„æ¨¡å¼:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> nullableString <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string[]</span>

<span class="token comment">// equivalent to</span>
z<span class="token punctuation">.</span><span class="token function">array</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="or"><a href="#or" class="header-anchor">#</a> <code>.or</code></h3> <p>ä¸€ä¸ªç”¨äºè”åˆç±»å‹çš„æ–¹ä¾¿æ–¹æ³•ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">or</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// string | number</span>

<span class="token comment">// equivalent to</span>
z<span class="token punctuation">.</span><span class="token function">union</span><span class="token punctuation">(</span><span class="token punctuation">[</span>z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="and"><a href="#and" class="header-anchor">#</a> <code>.and</code></h3> <p>ä¸€ä¸ªæ–¹ä¾¿çš„æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºäº¤å‰ç±»å‹ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span> age<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { name: string } &amp; { age: number }</span>

<span class="token comment">// equivalent to</span>
z<span class="token punctuation">.</span><span class="token function">intersection</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span> age<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">number</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h1 id="type-inference"><a href="#type-inference" class="header-anchor">#</a> Type inference</h1> <p>ä½ å¯ä»¥ç”¨<code>z.infer&lt;typeof mySchema&gt;</code>æå–ä»»ä½•æ¨¡å¼çš„ TypeScript ç±»å‹ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> <span class="token constant">A</span> <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token constant">A</span> <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span><span class="token keyword">typeof</span> <span class="token constant">A</span><span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string</span>

<span class="token keyword">const</span> u<span class="token operator">:</span> <span class="token constant">A</span> <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span> <span class="token comment">// TypeError</span>
<span class="token keyword">const</span> u<span class="token operator">:</span> <span class="token constant">A</span> <span class="token operator">=</span> <span class="token string">&quot;asdf&quot;</span><span class="token punctuation">;</span> <span class="token comment">// compiles</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="what-about-transforms"><a href="#what-about-transforms" class="header-anchor">#</a> What about transforms?</h4> <p>åœ¨ç°å®ä¸­ï¼Œæ¯ä¸ª Zod æ¨¡å¼å®é™…ä¸Šéƒ½ä¸<strong>ä¸¤ç§</strong>ç±»å‹ç›¸å…³ï¼šä¸€ä¸ªè¾“å…¥å’Œä¸€ä¸ªè¾“å‡ºã€‚å¯¹äºå¤§å¤šæ•°æ¨¡å¼ï¼ˆä¾‹å¦‚<code>z.string()</code>ï¼‰ï¼Œè¿™ä¸¤ç§ç±»å‹æ˜¯ç›¸åŒçš„ã€‚ä½†æ˜¯ä¸€æ—¦ä½ æŠŠè½¬æ¢æ·»åŠ åˆ°æ··åˆä¸­ï¼Œè¿™ä¸¤ä¸ªå€¼å°±ä¼šå‘ç”Ÿåˆ†æ­§ã€‚ä¾‹å¦‚ï¼Œ<code>z.string().transform(val =&gt; val.length)</code>çš„è¾“å…¥ä¸º<code>string</code>ï¼Œè¾“å‡ºä¸º<code>number</code>ã€‚</p> <p>ä½ å¯ä»¥åƒè¿™æ ·åˆ†åˆ«æå–è¾“å…¥å’Œè¾“å‡ºç±»å‹:</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> stringToNumber <span class="token operator">=</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> val<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// âš ï¸ Important: z.inferè¿”å›OUTPUTç±»å‹!</span>
<span class="token keyword">type</span> input <span class="token operator">=</span> z<span class="token punctuation">.</span>input<span class="token operator">&lt;</span>stringToNumber<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// string</span>
<span class="token keyword">type</span> output <span class="token operator">=</span> z<span class="token punctuation">.</span>output<span class="token operator">&lt;</span>stringToNumber<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// number</span>

<span class="token comment">// equivalent to z.output!</span>
<span class="token keyword">type</span> inferred <span class="token operator">=</span> z<span class="token punctuation">.</span>infer<span class="token operator">&lt;</span>stringToNumber<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// number</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h1 id="errors"><a href="#errors" class="header-anchor">#</a> Errors</h1> <p>Zod æä¾›äº†ä¸€ä¸ªåä¸º <code>ZodError</code> çš„é”™è¯¯å­ç±»ã€‚ZodErrors åŒ…å«ä¸€ä¸ª<code>issues</code> æ•°ç»„ï¼ŒåŒ…å«å…³äºéªŒè¯é—®é¢˜çš„è¯¦ç»†ä¿¡æ¯ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code><span class="token keyword">const</span> data <span class="token operator">=</span> z
  <span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> z<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">safeParse</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>data<span class="token punctuation">.</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  data<span class="token punctuation">.</span>error<span class="token punctuation">.</span>issues<span class="token punctuation">;</span>
  <span class="token comment">/* [
      {
        &quot;code&quot;: &quot;invalid_type&quot;,
        &quot;expected&quot;: &quot;string&quot;,
        &quot;received&quot;: &quot;number&quot;,
        &quot;path&quot;: [ &quot;name&quot; ],
        &quot;message&quot;: &quot;Expected string, received number&quot;
      }
  ] */</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="error-formatting"><a href="#error-formatting" class="header-anchor">#</a> Error formatting</h4> <p>ä½ å¯ä»¥ä½¿ç”¨<code>.format()</code>æ–¹æ³•å°†è¿™ä¸ªé”™è¯¯è½¬æ¢ä¸ºä¸€ä¸ªåµŒå¥—å¯¹è±¡ã€‚</p> <div class="language-ts line-numbers-mode"><pre class="language-ts"><code>data<span class="token punctuation">.</span>error<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/* {
  name: { _errors: [ 'Expected string, received number' ] }
} */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æœ€åæ›´æ–°æ—¶é—´:</span> <span class="time">7/5/2025, 11:30:54 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/front/js/ts.html" class="prev">
        typeScript å®è·µ
      </a></span> <span class="next"><a href="/front/js/åŸºç¡€å·¥å…·æ–¹æ³•.html">
        åŸºç¡€å·¥å…·æ–¹æ³•
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.cb69e367.js" defer></script><script src="/assets/js/2.97e62447.js" defer></script><script src="/assets/js/19.e931611d.js" defer></script>
  </body>
</html>
