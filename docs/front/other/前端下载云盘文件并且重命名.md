# 前端下载云盘文件并且重命名

```jsx
  function downloadBlob(data, filename, mimeType) {
    // 如果 data 不是 Blob，先转换成 Blob
    const blob = data instanceof Blob
      ? data
      : new Blob([data], { type: mimeType || 'text/vtt' });

    // 创建下载链接
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = filename || 'download';
    setDownloadLoading(false);
    // 触发下载
    document.body.appendChild(a);
    a.click();

    // 清理
    setTimeout(() => {
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }, 100);
  }


  const handleDownload = async () => {

    const vttRes = await fetchVttDetail(id);
    console.log(vttRes,"vttResvttRes")
    if (!vttRes.code === 200) {
      message.error(vttRes.msg);
      return;
    }
    const { originalCaptionsOss, captionsOss } = vttRes.data;
    const url = captionsOss || originalCaptionsOss;
    if (!videoDetail) {
      message.error('课程详情获取失败!');
      return;
    }
    setDownloadLoading(true);
    var xhr = new XMLHttpRequest();
    xhr.open('GET', url, true);
    xhr.responseType = 'blob'; // 设置响应类型为 blob

    xhr.onload = function () {
      if (xhr.status === 200) {
        // 获取响应数据（Blob对象）
        var blob = xhr.response;
        downloadBlob(blob, `${videoDetail.videoName}${videoDetail.id}字幕.vtt`); // 使用上面的 downloadBlob 方法
      } else {
        console.error('下载失败，状态码:', xhr.status);
      }
    };

    xhr.onerror = function () {
      console.error('请求失败');
      setDownloadLoading(false);

    };

    xhr.send();
  }
```